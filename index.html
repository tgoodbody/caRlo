<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="What the package does (one paragraph).">
<title>caRlo • caRlo</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="caRlo">
<meta property="og:description" content="What the package does (one paragraph).">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script><script defer data-domain="pkgdown.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">caRlo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="carlo">caRlo<a class="anchor" aria-label="anchor" href="#carlo"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The goal of <code>caRlo</code> is to create a simple way to implement Monte Carlo bootstrapping approaches. The package does the following:</p>
<ol style="list-style-type: decimal">
<li><p><code><a href="reference/monte_carlo.html">monte_carlo()</a></code> - Use Monte Carlo sampling to create a large number of samples from the population.</p></li>
<li><p><code><a href="reference/stats_nested.html">stats_nested()</a></code> - For each of these samples, calculate a statistic of interest (e.g. mean, median, variance).</p></li>
<li><p><code><a href="reference/bootstrap_stats.html">bootstrap_stats()</a></code> - Use bootstrapping on each set of sample statistics to estimate the distribution of the statistic of interest for the entire population.</p></li>
<li><p><code><a href="reference/stats_plot.html">stats_plot()</a></code> - Visualize statistical outputs</p></li>
</ol>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>To install <code>caRlo</code> from GitHub:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"tgoodbody/caRlo"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="bootstrapping">Bootstrapping<a class="anchor" aria-label="anchor" href="#bootstrapping"></a>
</h3>
<p>Monte Carlo bootstrapping involves creating a large number of random samples from the population using Monte Carlo sampling, and then applying bootstrapping to the set of sample statistics to estimate the distribution of the statistic of interest for the entire population.</p>
<p>The first step in Monte Carlo bootstrapping is to generate a large number of random samples from the population using Monte Carlo sampling. For example, if you are interested in estimating the mean height of a vegetation, you could generate a large number of random samples of height data from lidar data that acts as the population using Monte Carlo sampling.</p>
</div>
<div class="section level3">
<h3 id="sample-statistics">Sample statistics<a class="anchor" aria-label="anchor" href="#sample-statistics"></a>
</h3>
<p>Next, you would calculate the mean vegetation height for each of the random samples. This gives you a set of sample statistics representing the mean income for each of the random samples.You can then use bootstrapping to estimate the distribution of the mean vegetation height for the entire population based on these sample statistics.</p>
</div>
<div class="section level3">
<h3 id="bootstrap-statistics">Bootstrap statistics<a class="anchor" aria-label="anchor" href="#bootstrap-statistics"></a>
</h3>
<p>To estimate the distribution of the mean vegetation height, you would randomly select a subset of the sample statistics (with replacement) to create a new “bootstrap sample”. Then, you would calculate the mean (or any statistic of your choosing) of this bootstrap sample, and repeat this process many times to generate a large number of bootstrap means. These bootstrap means can be used to estimate the distribution of the mean vegetation height for the entire population, taking into account the variability of the sample means.</p>
<p>By combining Monte Carlo sampling and bootstrapping in this way, we can get a more accurate estimate of the statistic of interest and a better sense of its variability. This can be particularly useful in situations where we have limited data or need to make predictions about uncertain outcomes.</p>
</div>
</div>
<div class="section level2">
<h2 id="monte-carlo-sampling-for-forest-inventory">Monte Carlo sampling for forest inventory<a class="anchor" aria-label="anchor" href="#monte-carlo-sampling-for-forest-inventory"></a>
</h2>
<p>Lets assume we want to estimate the average height of trees over a landscape. Luckily, we have wall-to-wall lidar data over the forest, which is a remote sensing technology that uses laser pulses to measure the distance between the sensor and the ground surface, vegetation, or other objects. By analyzing the lidar data, we can estimate the height of trees in the forest. To do that we:</p>
<ol style="list-style-type: decimal">
<li><p>Choose the lidar metrics we want to sample on. For vegetation height the logical choice is a lidar metric like the p99 (99th percentile of height).</p></li>
<li><p>Choose a sampling method (e.g. simple random sampling, latin hypercube sampling etc.). You can choose multiple to compare estimates of height too!.</p></li>
<li><p>Perform repeated sampling at a determined sample size (<code>nSamp</code> in <code>caRlo</code>) for a discrete number of iterations (<code>iter</code>).</p></li>
</ol>
<p>Steps 1-3 are performed using the <code><a href="reference/monte_carlo.html">monte_carlo()</a></code> function. After samples have been selected we need to:</p>
<ol start="4" style="list-style-type: decimal">
<li><p>Calculate the average of the p99 metric for each sample.</p></li>
<li><p>Bootstrap the p99 average to estimate the distribution of the average tree height for the entire forest.</p></li>
</ol>
<p>During bootstrapping, random subsets of the sample averages (with replacement) are used to create a new “bootstrap sample”. Then, we calculate the mean of this bootstrap sample ( the average of averages :) ), and repeat this process many times to generate a large number of bootstrap means. These bootstrap means can be used to estimate the distribution of the average tree height for the entire forest, taking into account the variability of the sample means.</p>
<div class="section level3">
<h3 id="sample-size-optimization">Sample size optimization<a class="anchor" aria-label="anchor" href="#sample-size-optimization"></a>
</h3>
<p>Now, let’s assume we want to estimate the average height of trees using increasingly larger sample sizes. We can repeat the process described above for different sample sizes, ranging from small samples to large samples. We could start with a monte carlo sample approach for 50 where <code>nSamp = 50, iter = 100</code>. We could then repeat the process for larger sample sizes, <code>nSamp = c(50, 100, 200, 400, 800)</code>. Calculating bootstrapped statistics on these samples will give us a good sense of how the estimated average tree height changes as the sample size increases.</p>
<p>By using Monte Carlo sampling and bootstrapping at different sample sizes, we can estimate the variability of the average tree height for each sample size, and determine how many locations we need to sample in order to get a reliable estimate of the true average tree height for the entire forest. This can be useful information for forest management and conservation planning, as it can help us improved estimation methods track changes in forest health over time.</p>
</div>
<div class="section level3">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--- code in parallel ---#</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>cores <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># number of cores to use for processing</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#--- population mean and median ---#</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>population <span class="ot">&lt;-</span>  <span class="fu">data.frame</span>(<span class="at">sd =</span> <span class="fl">6.2</span>, <span class="at">mean =</span> <span class="fl">18.7</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#--- define parameters ---#</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> caRlo<span class="sc">:::</span>plots <span class="co"># internal test data with 1000 plots</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>nSamp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>) <span class="co"># Sample sizes for monte carlo simulations</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># number of monte carlo simulations per sample size</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#--- sample - generate stats - bootstrap stats ---#</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">monte_carlo</span>(<span class="at">data =</span> data, <span class="at">nSamp =</span> nSamp, <span class="at">iter =</span> tier, <span class="at">cores =</span> cores)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">#--- calculate statistics from monte carlo samples ---#</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> <span class="fu">stats_nested</span>(<span class="at">data =</span> samples, <span class="at">cores =</span> cores)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co">#--- bootstrap statistics of monte carlo samples ---#</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">bootstrap_stats</span>(<span class="at">data =</span> stats, <span class="at">population =</span> population, <span class="at">cores =</span> cores)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co">#--- plot bootstrap means of monte carlo samples with standard error ribbons for all metrics ---#</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="fu">stats_plot</span>(<span class="at">data =</span> bootstraps, <span class="at">type =</span> <span class="st">"mean"</span>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  </span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="specify-user-defined-functions-for-statistics-using-f">Specify user defined functions for statistics using <code>.f</code>
<a class="anchor" aria-label="anchor" href="#specify-user-defined-functions-for-statistics-using-f"></a>
</h2>
<p><code>caRlo</code> allows users to define the statistics they wish to calculate for monte carlo samples. This provides flexibility in what the user wants to compare.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- function needs to have more than 1 metric to give proper outputs ---#</span></span>
<span><span class="va">.f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co">#--- calculate the mean and percent of points less than the mean ---#</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>    perc_gr_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">x</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/stats_nested.html">stats_nested</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">caRlo</span><span class="fu">:::</span><span class="va">samples</span>, cores <span class="op">=</span> <span class="va">cores</span>, .f <span class="op">=</span> <span class="va">.f</span><span class="op">)</span></span>
<span></span>
<span><span class="va">s</span><span class="op">$</span><span class="va">statistics</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 3</span></span>
<span><span class="co">#&gt;   statistic    name  value</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 mean         zmean  8.92</span></span>
<span><span class="co">#&gt; 2 mean         zq90  17.9 </span></span>
<span><span class="co">#&gt; 3 mean         lai    2.30</span></span>
<span><span class="co">#&gt; 4 perc_gr_mean zmean  0.52</span></span>
<span><span class="co">#&gt; 5 perc_gr_mean zq90   0.46</span></span>
<span><span class="co">#&gt; 6 perc_gr_mean lai    0.52</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualze">Visualze<a class="anchor" aria-label="anchor" href="#visualze"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#--- population mean and median ---#</span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sd <span class="op">=</span> <span class="fl">1.1</span>, mean <span class="op">=</span> <span class="fl">2.2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#--- bootstrap statistics of monte carlo samples ---#</span></span>
<span><span class="va">bootstraps</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/bootstrap_stats.html">bootstrap_stats</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">caRlo</span><span class="fu">:::</span><span class="va"><a href="https://rdrr.io/r/stats/stats-package.html" class="external-link">stats</a></span>, population <span class="op">=</span> <span class="va">population</span>, cores <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following statistics do not match in 'data' and 'population. Dropping: sd</span></span>
<span></span>
<span><span class="co">#--- plot bootstrap means of monte carlo samples with standard error ribbons for all metrics ---#</span></span>
<span><span class="fu"><a href="reference/stats_plot.html">stats_plot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bootstraps</span>, type <span class="op">=</span> <span class="st">"mean"</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-3-1.png"><!-- --></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing caRlo</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Tristan R.H. Goodbody <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Tristan R.H. Goodbody.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
