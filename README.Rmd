---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# caRlo

<!-- badges: start -->
<!-- badges: end -->

The goal of `caRlo` is to perform monte carlo sampling simulations, calculate statistics on sample iterations, bootstrap statistics, and visualize statistical outputs.

## Installation

You can install the development version of caRlo from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("tgoodbody/caRlo")
```

## Example

This is a basic example which shows you how to solve a common problem:

```{r, echo = FALSE}
library(caRlo)
cores <- 5

population <- data.frame(median = 1.1, mean = 2.2)
```

```
#--- load internal data ---#

plots
stats
bootstraps

#--- fake population mean and median ---#
population <-  data.frame(median = 1.1, mean = 2.2)

#--- piped & parallel ---#

cores <- 5 # number of cores
iter <- 10 # number of monte carlo simulations per sample size

#--- sample - generate stats - bootstrap stats ---#
monte_carlo(plots, nSamp = c(50, 100, 150), iter = 10, cores = cores) %>%
  stats_nested(cores = cores) %>%
  bootstrap_stats(., population = population, cores = cores)
```

## Internal data for testing
```{r}
#--- raw plots
plots <- caRlo:::plots
gedi <- caRlo:::gedi

#--- samples from monte_carlo() ---#
samples <- caRlo:::samples

#--- stats from stats_nested() ---#
stats <- caRlo:::stats

#--- boostraps from bootstrap_stats() ---#
bootstraps <- caRlo:::bootstraps
```
```{r}
#--- sample ---#
monte_carlo(data = plots, nSamp = c(50, 100, 150), iter = 3, cores = cores)

#--- generate stats ---#
stats_nested(data = samples, cores = cores)

#--- boostrap statistics ---#
bootstrap_stats(data = stats, population = population, cores = cores)
```

## Specify user defined functions for statistics using `.f`
```{r}
#--- function needs to have more than 1 metric to give proper outputs ---#

.f <- function(x) {
  #--- calculate the mean and percent of points less than the mean ---#
  c(
    mean = mean(x),
    perc_gr_mean = length(x[x < mean(x)]) / length(x)
  )
}

s <- stats_nested(data = samples, cores = cores, .f = .f)

s$statistics[[1]]
```
